{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { jwtVerify } from \"jose\";\n\nexport async function middleware(request: NextRequest) {\n  const token = request.cookies.get(\"auth_token\")?.value;\n  const path = request.nextUrl.pathname;\n\n  const publicPaths = [\"/login\", \"/register\", \"/\"];\n\n  if (publicPaths.includes(path)) {\n    if (token && (path === \"/login\" || path === \"/register\")) {\n      try {\n        const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n        const { payload } = await jwtVerify(token, secret);\n        if (payload.role === \"client\") {\n          return NextResponse.redirect(new URL(\"/portal\", request.url));\n        }\n        return NextResponse.redirect(new URL(\"/admin\", request.url));\n      } catch {\n        return NextResponse.next();\n      }\n    }\n    return NextResponse.next();\n  }\n\n  if (!token) {\n    return NextResponse.redirect(new URL(\"/login\", request.url));\n  }\n\n  try {\n    const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n    const { payload } = await jwtVerify(token, secret);\n\n    if ((path.startsWith(\"/admin\") || path.startsWith(\"/team\")) && payload.role === \"client\") {\n      return NextResponse.redirect(new URL(\"/portal\", request.url));\n    }\n\n    if (path.startsWith(\"/portal\") && (payload.role === \"admin\" || payload.role === \"manager\")) {\n      return NextResponse.redirect(new URL(\"/admin\", request.url));\n    }\n\n    return NextResponse.next();\n  } catch {\n    const response = NextResponse.redirect(new URL(\"/login\", request.url));\n    response.cookies.delete(\"auth_token\");\n    return response;\n  }\n}\n\nexport const config = {\n  matcher: [\"/admin/:path*\", \"/portal/:path*\", \"/team/:path*\", \"/login\", \"/register\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IACjD,MAAM,OAAO,QAAQ,OAAO,CAAC,QAAQ;IAErC,MAAM,cAAc;QAAC;QAAU;QAAa;KAAI;IAEhD,IAAI,YAAY,QAAQ,CAAC,OAAO;QAC9B,IAAI,SAAS,CAAC,SAAS,YAAY,SAAS,WAAW,GAAG;YACxD,IAAI;gBACF,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU;gBAC9D,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO;gBAC3C,IAAI,QAAQ,IAAI,KAAK,UAAU;oBAC7B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;gBAC7D;gBACA,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;YAC5D,EAAE,OAAM;gBACN,OAAO,gMAAY,CAAC,IAAI;YAC1B;QACF;QACA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,CAAC,OAAO;QACV,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC5D;IAEA,IAAI;QACF,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU;QAC9D,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO;QAE3C,IAAI,CAAC,KAAK,UAAU,CAAC,aAAa,KAAK,UAAU,CAAC,QAAQ,KAAK,QAAQ,IAAI,KAAK,UAAU;YACxF,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;QAC7D;QAEA,IAAI,KAAK,UAAU,CAAC,cAAc,CAAC,QAAQ,IAAI,KAAK,WAAW,QAAQ,IAAI,KAAK,SAAS,GAAG;YAC1F,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,OAAO,gMAAY,CAAC,IAAI;IAC1B,EAAE,OAAM;QACN,MAAM,WAAW,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QACpE,SAAS,OAAO,CAAC,MAAM,CAAC;QACxB,OAAO;IACT;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;QAAkB;QAAgB;QAAU;KAAY;AACrF"}}]
}