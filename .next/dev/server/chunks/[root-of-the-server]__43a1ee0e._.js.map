{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/schema.ts"],"sourcesContent":["import { pgTable, text, timestamp, decimal, uuid } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  name: text(\"name\").notNull(),\n  role: text(\"role\").notNull().default(\"client\"),\n  avatar: text(\"avatar\"),\n  status: text(\"status\").default(\"offline\"),\n  clientId: uuid(\"client_id\").references(() => clients.id),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const clients = pgTable(\"clients\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  name: text(\"name\").notNull(),\n  contactPerson: text(\"contact_person\").notNull(),\n  email: text(\"email\").notNull(),\n  phone: text(\"phone\"),\n  status: text(\"status\").default(\"active\"),\n  totalRevenue: decimal(\"total_revenue\", { precision: 12, scale: 2 }).default(\"0\"),\n  logo: text(\"logo\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const projects = pgTable(\"projects\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  title: text(\"title\").notNull(),\n  clientId: uuid(\"client_id\").notNull().references(() => clients.id, { onDelete: \"cascade\" }),\n  status: text(\"status\").default(\"active\"),\n  progress: decimal(\"progress\", { precision: 5, scale: 2 }).default(\"0\"),\n  budget: decimal(\"budget\", { precision: 12, scale: 2 }),\n  deadline: timestamp(\"deadline\"),\n  assigneeId: uuid(\"assignee_id\").references(() => users.id),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const tasks = pgTable(\"tasks\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  projectId: uuid(\"project_id\").notNull().references(() => projects.id, { onDelete: \"cascade\" }),\n  assigneeId: uuid(\"assignee_id\").references(() => users.id),\n  status: text(\"status\").default(\"todo\"),\n  priority: text(\"priority\").default(\"medium\"),\n  dueDate: timestamp(\"due_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const invoices = pgTable(\"invoices\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  invoiceNumber: text(\"invoice_number\").notNull(),\n  clientId: uuid(\"client_id\").notNull().references(() => clients.id, { onDelete: \"cascade\" }),\n  amount: decimal(\"amount\", { precision: 12, scale: 2 }).notNull(),\n  status: text(\"status\").default(\"pending\"),\n  dueDate: timestamp(\"due_date\"),\n  paidDate: timestamp(\"paid_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  content: text(\"content\").notNull(),\n  senderId: uuid(\"sender_id\").notNull().references(() => users.id),\n  channel: text(\"channel\").default(\"general\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const activities = pgTable(\"activities\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: uuid(\"user_id\").notNull().references(() => users.id),\n  action: text(\"action\").notNull(),\n  target: text(\"target\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({ id: true, createdAt: true });\nexport const insertClientSchema = createInsertSchema(clients).omit({ id: true, createdAt: true });\nexport const insertProjectSchema = createInsertSchema(projects).omit({ id: true, createdAt: true });\nexport const insertTaskSchema = createInsertSchema(tasks).omit({ id: true, createdAt: true });\nexport const insertInvoiceSchema = createInsertSchema(invoices).omit({ id: true, createdAt: true });\nexport const insertMessageSchema = createInsertSchema(messages).omit({ id: true, createdAt: true });\nexport const insertActivitySchema = createInsertSchema(activities).omit({ id: true, createdAt: true });\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type Client = typeof clients.$inferSelect;\nexport type InsertClient = z.infer<typeof insertClientSchema>;\nexport type Project = typeof projects.$inferSelect;\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Task = typeof tasks.$inferSelect;\nexport type InsertTask = z.infer<typeof insertTaskSchema>;\nexport type Invoice = typeof invoices.$inferSelect;\nexport type InsertInvoice = z.infer<typeof insertInvoiceSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type Activity = typeof activities.$inferSelect;\nexport type InsertActivity = z.infer<typeof insertActivitySchema>;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/postgres-js\";\nimport postgres from \"postgres\";\nimport * as schema from \"./schema\";\n\nconst connectionString = process.env.DATABASE_URL!;\n\nconst client = postgres(connectionString);\nexport const db = drizzle(client, { schema });\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,MAAM,SAAS,IAAA,qJAAQ,EAAC;AACjB,MAAM,KAAK,IAAA,uKAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\";\nimport { cookies } from \"next/headers\";\nimport { db } from \"./db\";\nimport { users } from \"./schema\";\nimport { eq } from \"drizzle-orm\";\nimport bcrypt from \"bcryptjs\";\n\nif (!process.env.JWT_SECRET) {\n  throw new Error(\"JWT_SECRET environment variable is required\");\n}\nconst secret = new TextEncoder().encode(process.env.JWT_SECRET);\n\nexport async function createToken(payload: { userId: string; role: string }) {\n  const token = await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setExpirationTime(\"7d\")\n    .sign(secret);\n  return token;\n}\n\nexport async function verifyToken(token: string) {\n  try {\n    const { payload } = await jwtVerify(token, secret);\n    return payload as { userId: string; role: string };\n  } catch {\n    return null;\n  }\n}\n\nexport async function getCurrentUser() {\n  const cookieStore = cookies();\n  const token = cookieStore.get(\"auth_token\")?.value;\n  \n  if (!token) return null;\n  \n  const payload = await verifyToken(token);\n  if (!payload) return null;\n  \n  const [user] = await db.select().from(users).where(eq(users.id, payload.userId));\n  if (!user) return null;\n  \n  const { password, ...userWithoutPassword } = user;\n  return userWithoutPassword;\n}\n\nexport async function login(email: string, passwordInput: string) {\n  const [user] = await db.select().from(users).where(eq(users.email, email));\n  if (!user) return { error: \"Invalid credentials\" };\n  \n  const valid = await bcrypt.compare(passwordInput, user.password);\n  if (!valid) return { error: \"Invalid credentials\" };\n  \n  const token = await createToken({ userId: user.id, role: user.role });\n  const { password, ...userWithoutPassword } = user;\n  \n  return { user: userWithoutPassword, token };\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,UAAU,EAAE;IAC3B,MAAM,IAAI,MAAM;AAClB;AACA,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU;AAEvD,eAAe,YAAY,OAAyC;IACzE,MAAM,QAAQ,MAAM,IAAI,kKAAO,CAAC,SAC7B,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,MAClB,IAAI,CAAC;IACR,OAAO;AACT;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,IAAA,4IAAO;IAC3B,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAE7C,IAAI,CAAC,OAAO,OAAO;IAEnB,MAAM,UAAU,MAAM,YAAY;IAClC,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,CAAC,KAAK,GAAG,MAAM,iHAAE,CAAC,MAAM,GAAG,IAAI,CAAC,wHAAK,EAAE,KAAK,CAAC,IAAA,0KAAE,EAAC,wHAAK,CAAC,EAAE,EAAE,QAAQ,MAAM;IAC9E,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,EAAE,QAAQ,EAAE,GAAG,qBAAqB,GAAG;IAC7C,OAAO;AACT;AAEO,eAAe,MAAM,KAAa,EAAE,aAAqB;IAC9D,MAAM,CAAC,KAAK,GAAG,MAAM,iHAAE,CAAC,MAAM,GAAG,IAAI,CAAC,wHAAK,EAAE,KAAK,CAAC,IAAA,0KAAE,EAAC,wHAAK,CAAC,KAAK,EAAE;IACnE,IAAI,CAAC,MAAM,OAAO;QAAE,OAAO;IAAsB;IAEjD,MAAM,QAAQ,MAAM,0KAAM,CAAC,OAAO,CAAC,eAAe,KAAK,QAAQ;IAC/D,IAAI,CAAC,OAAO,OAAO;QAAE,OAAO;IAAsB;IAElD,MAAM,QAAQ,MAAM,YAAY;QAAE,QAAQ,KAAK,EAAE;QAAE,MAAM,KAAK,IAAI;IAAC;IACnE,MAAM,EAAE,QAAQ,EAAE,GAAG,qBAAqB,GAAG;IAE7C,OAAO;QAAE,MAAM;QAAqB;IAAM;AAC5C"}},
    {"offset": {"line": 347, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { cookies } from \"next/headers\";\nimport { login } from \"@/lib/auth\";\n\nexport async function POST(request: Request) {\n  try {\n    const { email, password } = await request.json();\n\n    if (!email || !password) {\n      return NextResponse.json({ error: \"Email and password required\" }, { status: 400 });\n    }\n\n    const result = await login(email, password);\n\n    if (result.error) {\n      return NextResponse.json({ error: result.error }, { status: 401 });\n    }\n\n    const cookieStore = cookies();\n    cookieStore.set(\"auth_token\", result.token!, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: 60 * 60 * 24 * 7,\n      path: \"/\",\n    });\n\n    return NextResponse.json({ user: result.user });\n  } catch (error) {\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,MAAM,SAAS,MAAM,IAAA,sHAAK,EAAC,OAAO;QAElC,IAAI,OAAO,KAAK,EAAE;YAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,OAAO,KAAK;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAClE;QAEA,MAAM,cAAc,IAAA,4IAAO;QAC3B,YAAY,GAAG,CAAC,cAAc,OAAO,KAAK,EAAG;YAC3C,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM,OAAO,IAAI;QAAC;IAC/C,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}